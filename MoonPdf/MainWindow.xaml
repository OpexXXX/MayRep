<Window x:Class="MoonPdf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mpp="clr-namespace:MoonPdfLib;assembly=MoonPdfLib"
        xmlns:mpd="clr-namespace:MoonPdf"
        xmlns:System="clr-namespace:System;assembly=mscorlib"
        Title="ATPWorker" WindowStartupLocation="CenterScreen" Height="864.5" Width="581.5" UseLayoutRounding="True" MinHeight="300" MinWidth="430" Icon="Resources/iconATP.ico" ScrollViewer.CanContentScroll="True" Drop="Window_Drop" AllowDrop="True" Unloaded="Window_Unloaded" Closing="Window_Closing">
    <Window.Resources>
        <Style x:Key="GroupHeaderStyle" TargetType="{x:Type GroupItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GroupItem}">
                        <Expander x:Name="exp" IsExpanded="False" Background="White" Foreground="Black">
                            <Expander.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="groupText"  Text="{Binding Path=Name}" />
                                    <TextBlock Text="{Binding Path=ItemCount}" Margin="8,0,4,0"/>
                                    <TextBlock Text="шт."/>
                                </StackPanel>
                            </Expander.Header>
                            <ItemsPresenter/>
                        </Expander>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="GroupHeaderStyle1" TargetType="{x:Type GroupItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GroupItem}">
                        <Expander x:Name="exp" IsExpanded="False" Background="White" Foreground="Black">
                            <Expander.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="groupText"  Text="{Binding Path=Name}" />
                                    <TextBlock Text="{Binding Path=ItemCount}" Margin="8,0,4,0"/>
                                    <TextBlock Text="шт."/>
                                </StackPanel>
                            </Expander.Header>
                            <ItemsPresenter/>
                        </Expander>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <BooleanToVisibilityConverter x:Key="VisConverter"/>

    </Window.Resources>

    <Grid Margin="0,0,0,0">
        <StatusBar Margin="0,803,171,0">
            <TextBlock x:Name="statusStripText" Height="16"/>
        </StatusBar>
        <Menu x:Name="menu" Margin="0,0,0,808">
            <MenuItem Header="Фаил" >
                <MenuItem Header="Добавить Акты тех проверок" Click="MenuItem_Click"/>
                <Separator  Margin="1" />
                <MenuItem Header="Сохранить как..." Click="MenuItemSaveAtpFile"/>
                <MenuItem Header="Сохранить " Click="SaveAtpList"/>
                <Separator  Margin="1" />
                <MenuItem Header="Загрузить" Click="MenuItemLoadAtpFile"/>
                <Separator  Margin="1" />
                <MenuItem Header="Выход" Click="MenuItem_Click_1"/>
            </MenuItem>
            <MenuItem Header="Акты тех. проверок" >
                <MenuItem Header="Обработать заполненные акты" Click="MenuItemMoveAktToComplete"/>
                <MenuItem Header="Создать сопроводиловку" Click="MenuItemCreateExcel"/>
                <Separator  Margin="1" />
                <MenuItem Header="Занести в SAP" Click="MenuItem_Click_2"/>
            </MenuItem>
            <MenuItem Header="База" >
                <MenuItem Header="Обновить из excel" Click="MenuItem_RefreshDb"/>
            </MenuItem>
        </Menu>
        <StatusBar Height="31" VerticalAlignment="Top" HorizontalAlignment="Right" Width="166" Margin="0,803,0,0">
            <ProgressBar x:Name="progressBar" Height="21" Width="155" RenderTransformOrigin="0.5,0.5" Value="100" Cursor="None">
                <ProgressBar.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform/>
                        <SkewTransform/>
                        <RotateTransform Angle="0.136"/>
                        <TranslateTransform/>
                    </TransformGroup>
                </ProgressBar.RenderTransform>
            </ProgressBar>
        </StatusBar>
        <TabControl x:Name="tabControlMain" Margin="0,26,0,31" >
            <TabItem Header="Тех. проверки" FontSize="14">
                <Grid Margin="0,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="371"/>
                    </Grid.ColumnDefinitions>
                    <GridSplitter x:Name="gridSplitter" Grid.Column="1" HorizontalAlignment="Left" Height="718" VerticalAlignment="Top" Width="5" Grid.RowSpan="3" Margin="0,0,0,-101"/>
                    <TabControl x:Name="tabControl" Grid.Column="1" Margin="5,0,0,1" RenderTransformOrigin="0.5,0.5" Grid.Row="1">
                        <TabControl.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="0.046"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </TabControl.RenderTransform>
                        <TabItem Header="Заполнение" FontSize="14">
                            <Grid Background="#FFE5E5E5" Margin="0,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="74"/>
                                    <RowDefinition x:Name="PotrGridColumn" Height="53"/>
                                    <RowDefinition Height="55"/>
                                    <RowDefinition x:Name="rowToHide" Height="101"/>
                                    <RowDefinition x:Name="GridPU" Height="73"/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <GroupBox x:Name="groupBox" Header="Номер акта" Margin="0,1" Grid.Row="1">
                                    <Grid Margin="0,0,0,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="27"/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="93"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock x:Name="textBlock" HorizontalAlignment="Left" Margin="4,3,0,0" TextWrapping="Wrap" Text="Номер 91/Е-" VerticalAlignment="Top" Height="19" Width="96"/>
                                        <TextBox x:Name="textBox" Grid.Column="1" HorizontalAlignment="Left" Height="23" TextWrapping="Wrap" Text="{Binding Path=Number}" VerticalAlignment="Top" Width="83" MaxLength="5" KeyDown="textBox_KeyDown" KeyUp="textBox_KeyUp"/>
                                        <DatePicker x:Name="dateTimePicker1"
                                        SelectedDate ="{Binding Path=DateWork}"
                                        Grid.Column="2" HorizontalAlignment="Left" Margin="0,-1,0,0"  
                                       VerticalAlignment="Top" Height="27" Width="111" SelectedDateFormat="Short" KeyDown="dateTimePicker1_KeyDown" IsVisibleChanged="dateTimePicker1_IsVisibleChanged" KeyUp="dateTimePicker1_KeyUp" DisplayDateEnd="2025-12-31" DisplayDateStart="2017-01-01" TextOptions.TextFormattingMode="Display" IsManipulationEnabled="True">
                                            <DatePicker.BlackoutDates>
                                                <CalendarDateRange End="2017-01-01" Start="2025-12-31"/>
                                            </DatePicker.BlackoutDates>
                                        </DatePicker>
                                        <CheckBox x:Name="radioButton"  IsChecked="{Binding Path=DopuskFlag}" Content="Допуск" HorizontalAlignment="Left" Margin="10,0,0,0" Grid.Row="1" VerticalAlignment="Top" Width="81"  Height="19" Checked="radioButton_Checked"/>
                                        <CheckBox x:Name="radioButton1" IsChecked="{Binding Path=ProverkaFlag}" Content="Проверка" Grid.Column="1" HorizontalAlignment="Left" Grid.Row="1" VerticalAlignment="Top" Height="19" Width="105" Grid.ColumnSpan="2" Checked="radioButton1_Checked"/>
                                        <Image x:Name="image" Grid.Column="2" Visibility="{Binding Path=Complete, Converter={StaticResource VisConverter}}" HorizontalAlignment="Left" Height="46" Margin="116,0,-5,0" Grid.RowSpan="2" VerticalAlignment="Top" Width="40" Source="Resources/ok.png" AllowDrop="True"/>
                                    </Grid>
                                </GroupBox>
                                <GroupBox x:Name="groupBox1" Header="Потребитель" Grid.Row="2" Margin="0,2,0,0">
                                    <Grid Margin="0,0,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="73"/>
                                            <ColumnDefinition Width="119"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25"/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <TextBlock x:Name="textBlock1" HorizontalAlignment="Left" Margin="3,3,0,0" TextWrapping="Wrap" Text="№Л/С" VerticalAlignment="Top" Height="19" Width="60"/>
                                        <TextBox x:Name="textBox1" HorizontalAlignment="Left" Height="23" TextWrapping="Wrap" Text="{Binding Path=NumberLS}"   VerticalAlignment="Top" Width="120" Grid.Column="1" Grid.ColumnSpan="2" KeyDown="textBox1_KeyDown" MaxLength="12"/>
                                        <TextBlock x:Name="textBlock2" Margin="3,20,0,1" TextWrapping="Wrap" Text="{Binding Path=FIO}" Grid.ColumnSpan="3" Grid.Row="1"/>
                                        <TextBlock x:Name="textBlock3" Grid.Row="1" TextWrapping="Wrap" Text="{Binding Path=Adress}" Grid.ColumnSpan="3" Margin="3,0,0,0" Height="19" VerticalAlignment="Top"/>
                                    </Grid>
                                </GroupBox>
                                <GroupBox x:Name="groupBox2" Header="Агенты" Grid.Row="3">
                                    <Grid Margin="0,0,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="167"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <ComboBox x:Name="comboBox" VerticalAlignment="Top" Height="25" SelectedItem="{Binding Agent_1}" Margin="0,0,10,0">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Path=Surname}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                        <ComboBox x:Name="comboBox1" Grid.Column="1" HorizontalAlignment="Left" Margin="10,0,0,0" VerticalAlignment="Top" Width="157" Height="25" SelectedItem="{Binding Agent_2}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Path=Surname}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </Grid>
                                </GroupBox>
                                <GroupBox x:Name="groupBox3" Header="Допускаемый прибор учета" Grid.Row="4" Height="101" VerticalAlignment="Top">
                                    <Grid Margin="0,0,0,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="21"/>
                                            <RowDefinition Height="28"/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="95"/>
                                            <ColumnDefinition Width="143"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock x:Name="textBlock4" HorizontalAlignment="Left" TextWrapping="Wrap" VerticalAlignment="Top" Grid.Column="1" Height="21" Width="66" Margin="10,0,0,0"><Run Text="Номер"/><LineBreak/><Run/></TextBlock>
                                        <TextBlock x:Name="textBlock5" HorizontalAlignment="Left" TextWrapping="Wrap" Text="Тип" VerticalAlignment="Top" Height="19" Width="24" Margin="10,2,0,0"/>
                                        <TextBlock x:Name="textBlock6" Grid.Column="2" HorizontalAlignment="Left" TextWrapping="Wrap" Text="Показание" VerticalAlignment="Top" Width="83" Height="19" Margin="10,0,0,0"/>
                                        <ComboBox x:Name="comboBox2" SelectedItem="{Binding PuNewType}"
                                      HorizontalAlignment="Left" Grid.Row="1" VerticalAlignment="Top" Width="95" Height="25" TextOptions.TextFormattingMode="Display">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Path=Nazvanie}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>

                                        <TextBox x:Name="textBox2" Text="{Binding Path=PuNewNumber}" Grid.Column="1" HorizontalAlignment="Left" Height="25" Grid.Row="1" TextWrapping="Wrap" VerticalAlignment="Top" Width="133" Margin="5,0,0,0"/>
                                        <TextBox x:Name="textBox3" 
                                     Text="{Binding Path=PuNewPokazanie
                                }" Grid.Column="2" HorizontalAlignment="Left" Height="25" Grid.Row="1" TextWrapping="Wrap"  VerticalAlignment="Top" Width="96" MaxLength="7"/>
                                        <TextBlock x:Name="textBlock7" HorizontalAlignment="Left" Margin="10,5,0,0" Grid.Row="2" TextWrapping="Wrap" Text="Поверка" VerticalAlignment="Top" Height="19" Width="59"/>
                                        <TextBox x:Name="textBox4"  Text="{Binding Path=PuNewPoverkaEar}"
                                     Grid.Column="1" HorizontalAlignment="Left" Height="23" Margin="0,2,0,0" Grid.Row="2" TextWrapping="Wrap"  VerticalAlignment="Top" Width="44" VerticalScrollBarVisibility="Disabled" MaxLength="4" Unloaded="textBox4_Unloaded"/>
                                        <TextBox x:Name="textBox5"  Text="{Binding Path=PuNewPoverKvartal}" Grid.Column="1" HorizontalAlignment="Left" Height="23" Grid.Row="2" TextWrapping="Wrap" VerticalAlignment="Top" Width="20" Margin="49,2,0,0" MaxLength="1" MaxLines="1"/>
                                        <TextBlock x:Name="textBlock8" Grid.Column="1" HorizontalAlignment="Left" Margin="74,5,0,-3" Grid.Row="2" TextWrapping="Wrap" Text="Квартал" VerticalAlignment="Top"/>

                                    </Grid>
                                </GroupBox>
                                <GroupBox x:Name="groupBox4" Header="Прибор учета" Grid.Row="5" Margin="0,0,0,0">
                                    <Grid Margin="0,0,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="183"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition x:Name="RowPU" Height="0"/>
                                            <RowDefinition Height="27"/>
                                            <RowDefinition Height="21"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock x:Name="textBlock9" Margin="10,0,0,1" TextWrapping="Wrap" Text="{Binding Path=PuOldType}" Grid.ColumnSpan="2"/>
                                        <TextBox x:Name="textBox6" Text="{Binding Path=PuOldNumber}" HorizontalAlignment="Left" Height="23" Margin="59,0,0,0" Grid.Row="1" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" KeyDown="textBox6_KeyDown"/>
                                        <TextBlock x:Name="textBlock10" HorizontalAlignment="Left" Margin="10,3,0,0" Grid.Row="1" TextWrapping="Wrap" Text="Номер" VerticalAlignment="Top" Height="19" Width="44"/>
                                        <TextBlock x:Name="textBlock11" Grid.Column="1" HorizontalAlignment="Left" Margin="1,3,0,0" Grid.Row="1" TextWrapping="Wrap" Text="Показание" VerticalAlignment="Top" Height="19" Width="74"/>
                                        <TextBox x:Name="textBox7" Text="{Binding Path=PuOldPokazanie}" Grid.Column="1" HorizontalAlignment="Left" Height="23" Margin="75,0,0,0" Grid.Row="1" TextWrapping="Wrap" VerticalAlignment="Top" Width="76" MaxLength="7"/>
                                        <CheckBox x:Name="checkBox" Content="Истек МПИ " HorizontalAlignment="Left" Margin="10,0,0,0" Grid.Row="2" VerticalAlignment="Top" Height="19" Width="95" 
                                      IsChecked="{Binding Path=PuOldMPI}"/>

                                    </Grid>
                                </GroupBox>
                                <GroupBox x:Name="groupBox5" Header="Пломбы" Grid.Row="6" Margin="0,0,0,0">
                                    <Grid Margin="0,0,0,0">

                                        <DataGrid x:Name="dataGrid" IsSynchronizedWithCurrentItem="True" HeadersVisibility="Column" AutoGenerateColumns="False" MouseDoubleClick="dataGrid_MouseDoubleClick" Grid.RowSpan="2" KeyDown="dataGrid_KeyDown" CanUserResizeRows="False" >
                                            <DataGrid.Resources>
                                                <ContextMenu x:Key="ticketContextMenu">
                                                    <ContextMenu.Items>
                                                        <MenuItem
                                              Header="Дублировать"
                                             Click="Dublirovat"/>
                                                        <MenuItem
                                              Header="Удалить"
                                             Click="RemovPlobmFroDataGrid"/>
                                                        <MenuItem
                                              Header="Добавить"
                                             Click="AddPlombIncrement"/>
                                                    </ContextMenu.Items>
                                                </ContextMenu>
                                            </DataGrid.Resources>
                                            <DataGrid.RowStyle>
                                                <Style TargetType="DataGridRow" BasedOn="{StaticResource {x:Type DataGridRow}}">
                                                    <Setter Property="ContextMenu" Value="{StaticResource ticketContextMenu}" />
                                                </Style>
                                            </DataGrid.RowStyle>
                                            <DataGrid.Columns>
                                                <DataGridComboBoxColumn x:Name="dataGridComboType" IsReadOnly="False" SelectedItemBinding="{Binding Type}" Header="Тип"/>
                                                <DataGridTextColumn Binding="{Binding Number}" Header="Номер"/>
                                                <DataGridTextColumn Binding="{Binding Place}" Header="Место установки"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                                </GroupBox>
                                <ComboBox x:Name="comboBox3" Margin="212,1,0,0" VerticalAlignment="Top" Height="25" SelectedItem="{Binding AktATPInWork}" SelectionChanged="comboBox3_SelectionChanged_1">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="15"/>
                                                    <ColumnDefinition/>
                                                </Grid.ColumnDefinitions>
                                                <Image  x:Name="imageCombo" Visibility="{Binding Path=Complete, Converter={StaticResource VisConverter}}" HorizontalAlignment="Stretch" Height="20" Margin="0,0,0,0"  Width="Auto" Source="Resources/ok.png" AllowDrop="True"/>
                                                <TextBlock Grid.Column="1" Text="{Binding Path=Title}" />
                                            </Grid>

                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                    
                                </ComboBox>
                                <Button x:Name="button2" Content="Назад" HorizontalAlignment="Left" Margin="0,1,0,0" VerticalAlignment="Top" Width="75" Click="button2_Click" Height="25"/>
                                <Button x:Name="button3" Content="1" HorizontalAlignment="Left" VerticalAlignment="Top" Width="30" Margin="75,1,0,0" Click="button3_Click" Height="25"/>
                                <Button x:Name="button4" Content="2" HorizontalAlignment="Left" Margin="106,1,0,0" VerticalAlignment="Top" Width="31" Click="button4_Click" Height="25"/>
                                <Button x:Name="button5" Content="Вперед" HorizontalAlignment="Left" Margin="137,1,0,0" VerticalAlignment="Top" Width="75" Click="button5_Click" Height="25"/>
                            </Grid>

                        </TabItem >
                        <TabItem Header="Отправленные акты" FontSize="14">
                            <Grid Background="#FFE5E5E5" Margin="0,0,0,0">
                                <DataGrid x:Name="DataGridMailedAkt" Margin="0,25,0,0" IsReadOnly="False" CanUserAddRows="False" SelectionChanged="DataGridMailedAkt_SelectionChanged">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Title}" Header="Номер"/>
                                        <DataGridTextColumn Binding="{Binding TypeOfWork}" Header="Тип"/>
                                        <DataGridTextColumn Binding="{Binding NumberLS}" Header="Л/С"/>
                                        <DataGridTextColumn Binding="{Binding FIO}" Header="Ф.И.О."/>
                                        <DataGridTextColumn Binding="{Binding Adress}" Header="Адрес"/>
                                        <DataGridComboBoxColumn x:Name="dataGridComboTypePU" IsReadOnly="False" SelectedItemBinding="{Binding SapNumberPU}" Header="Новый ПУ"/>
                                    </DataGrid.Columns>
                                    <DataGrid.GroupStyle>
                                        <GroupStyle ContainerStyle="{StaticResource GroupHeaderStyle}">
                                            <GroupStyle.Panel>
                                                <ItemsPanelTemplate>
                                                    <DataGridRowsPresenter/>
                                                </ItemsPanelTemplate>
                                            </GroupStyle.Panel>
                                        </GroupStyle>
                                        <GroupStyle>
                                            <GroupStyle.HeaderTemplate>
                                                <DataTemplate>
                                                    <DockPanel Background="LightGray">
                                                        <TextBlock Text="{Binding Path=Name}" Foreground="Black" Margin="40,0,0,0"/>
                                                        <TextBlock Text="{Binding Path=ItemCount}" Foreground="Black" Margin="10,0,0,0"/>
                                                        <TextBlock Text="шт." Foreground="Black" Margin="1,0,0,0"/>
                                                    </DockPanel>
                                                </DataTemplate>
                                            </GroupStyle.HeaderTemplate>
                                        </GroupStyle>


                                    </DataGrid.GroupStyle>
                                </DataGrid>
                            </Grid>
                        </TabItem >
                        <TabItem Header="Акты в работе" FontSize="14">
                            <Grid Background="#FFE5E5E5" Margin="0,-4,0,4">
                                <DataGrid x:Name="dataGrid1" Margin="0,0,0,0" IsSynchronizedWithCurrentItem="True" HeadersVisibility="Column" AutoGenerateColumns="True" SelectionUnit="CellOrRowHeader" >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Title}" Header="Номер"/>
                                        <DataGridTextColumn Binding="{Binding TypeOfWork}" Header="Тип"/>
                                        <DataGridTextColumn Binding="{Binding NumberLS}" Header="Л/С"/>
                                        <DataGridTextColumn Binding="{Binding FIO}" Header="Ф.И.О."/>
                                        <DataGridTextColumn Binding="{Binding Adress}" Header="Адрес"/>
                                    </DataGrid.Columns>
                                    <DataGrid.GroupStyle>
                                        <GroupStyle ContainerStyle="{StaticResource GroupHeaderStyle1}">
                                            <GroupStyle.Panel>
                                                <ItemsPanelTemplate>
                                                    <DataGridRowsPresenter/>
                                                </ItemsPanelTemplate>
                                            </GroupStyle.Panel>
                                        </GroupStyle>

                                    </DataGrid.GroupStyle>
                                </DataGrid>

                            </Grid>
                        </TabItem>
                        <TabItem Header="Заполненные акты" FontSize="14">
                            <Grid Background="#FFE5E5E5" Margin="0,-4,0,4">
                                <DataGrid x:Name="dataGridComplete" IsSynchronizedWithCurrentItem="True" HeadersVisibility="Column" AutoGenerateColumns="True" Margin="0,31,0,0" SelectionChanged="dataGridComplete_SelectionChanged" >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Title}" Header="Номер"/>
                                        <DataGridTextColumn Binding="{Binding TypeOfWork}" Header="Тип"/>
                                        <DataGridTextColumn Binding="{Binding NumberLS}" Header="Л/С"/>
                                        <DataGridTextColumn Binding="{Binding FIO}" Header="Ф.И.О."/>
                                        <DataGridTextColumn Binding="{Binding Adress}" Header="Адрес"/>
                                    </DataGrid.Columns>

                                    <DataGrid.GroupStyle>

                                        <GroupStyle>
                                            <GroupStyle.HeaderTemplate>
                                                <DataTemplate>
                                                    <DockPanel Background="LightGray">
                                                        <TextBlock Text="{Binding Path=Name}" Foreground="Black" Margin="40,0,0,0"/>
                                                        <TextBlock Text="{Binding Path=ItemCount}" Foreground="Black" Margin="10,0,0,0"/>
                                                        <TextBlock Text="шт." Foreground="Black" Margin="1,0,0,0"/>
                                                    </DockPanel>
                                                </DataTemplate>
                                            </GroupStyle.HeaderTemplate>
                                        </GroupStyle>
                                    </DataGrid.GroupStyle>
                                </DataGrid>
                                <TextBox x:Name ="numberMailTextBlock" HorizontalAlignment="Left" Height="23" Margin="55,3,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Top" Width="64"/>
                                <TextBlock HorizontalAlignment="Left" Margin="10,6,0,0" TextWrapping="Wrap" Text="исх.№" VerticalAlignment="Top"/>
                                <DatePicker x:Name ="dateMail" HorizontalAlignment="Left" Margin="143,2,0,0" VerticalAlignment="Top"/>
                                <TextBlock HorizontalAlignment="Left" Margin="124,6,0,0" TextWrapping="Wrap" Text="от" VerticalAlignment="Top"/>
                                <Button Content="Сделать" HorizontalAlignment="Left" Margin="259,3,0,0" VerticalAlignment="Top" Width="87" Click="Button_Click"/>
                            </Grid>
                        </TabItem>
                    </TabControl>
                    <mpp:MoonPdfPanel Background="LightGray" ViewType="SinglePage" PageRowDisplay="ContinuousPageRows" PageMargin="0,2,4,2" x:Name="moonPdfPanel" x:FieldModifier="private" RenderTransformOrigin="0.243,0.495" Margin="0,1,0,0" Grid.Row="1" PageRowDisplayChanged="moonPdfPanel_PageRowDisplayChanged" AllowDrop="False" PdfLoaded="moonPdfPanel_PdfLoaded"/>
                </Grid>
            </TabItem>
            <TabItem Header="Внеплан" FontSize="14">
                <Grid Margin="0,0,0,0">
                    <DataGrid x:Name="dataGridOplombirovki" Margin="0,0,0,10"/>
                </Grid>
            </TabItem>
            <TabItem Header="Акты БУ" FontSize="14">
                <Grid Margin="0,0,0,0">
                    <TabControl x:Name="tabControlBU" Margin="0,0,0,0" >
                        <TabItem Header="Занесение" FontSize="14">
                            <Grid Margin="0,0,0,0">

                            </Grid>
                        </TabItem>
                        <TabItem Header="Реестр" FontSize="14">
                            <Grid Margin="0,0,0,0">

                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>

        </TabControl>
    </Grid>
</Window>
